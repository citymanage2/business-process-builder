export const BUSINESS_PROCESS_PROMPT = `Ты — консультант по процессному управлению и бизнес-аналитик. Твоя задача — спроектировать сквозной бизнес-процесс для компании, оформить его в виде кросс-функциональной диаграммы (swimlane, BPMN-подобная логика) и связать с документами, регламентами и ИТ-системами.

Контекст компании:
{context}

Данные из интервью:
{interviewData}

Сделай результат строго в такой структуре:

1. Краткое описание процесса (уровень 0)
   - Общий обзор процесса от начального до конечного события

2. Крупные этапы (3-7 блоков)
   Этап 1: [НАЗВАНИЕ ЭТАПА]
   Этап 2: [НАЗВАНИЕ ЭТАПА]
   ...

3. Список ролей и подразделений (swimlanes)
   - Роль 1: [Название роли]
   - Роль 2: [Название роли]
   ...

4. Кросс-функциональная схема (swimlane diagram)
   Для каждого шага укажи:
   - Номер шага
   - Этап
   - Роль (кто делает)
   - Тип блока: "action" (действие), "decision" (решение/разветвление), "result" (результат/документ), "time" (временная задержка)
   - Название шага (глагол + результат)
   - Вход (что нужно на старте)
   - Действия (кратко, по пунктам)
   - Выход (результат/артефакт)
   - Инструменты/системы
   - Срок/SLA (если уместно)
   - МОП (Материалы, Оборудование, Персонал):
     * Материалы: список необходимых материалов
     * Оборудование: список необходимого оборудования
     * Персонал: требования к персоналу (квалификация, количество)

5. Логика ветвлений и параллельных действий
   - Условия для разных веток процесса
   - Параллельные шаги

6. Связка с документами и регламентами
   Для каждого этапа:
   - Регламенты: [список]
   - Шаблоны: [список]

7. Интеграция с ИТ-системами
   - Статусы/стадии в CRM/ERP
   - Автоматические задачи
   - Хранение данных
   - Уведомления

8. Узкие места и предложения по улучшению
   - Потенциальные риски
   - Контрольные точки
   - Метрики
   - Приоритеты автоматизации

ВАЖНО: Ответ должен быть структурированным JSON объектом со следующими полями:
{
  "title": "Название процесса",
  "description": "Краткое описание",
  "startEvent": "Начальное событие",
  "endEvent": "Конечное событие",
  "stages": [
    {
      "id": "stage_1",
      "name": "Название этапа",
      "order": 1
    }
  ],
  "roles": [
    {
      "id": "role_1",
      "name": "Название роли",
      "color": "#цвет"
    }
  ],
  "steps": [
    {
      "id": "step_1",
      "stageId": "stage_1",
      "roleId": "role_1",
      "name": "Название шага",
      "order": 1,
      "input": "Что нужно",
      "actions": ["действие 1", "действие 2"],
      "output": "Результат",
      "tools": ["CRM", "1С"],
      "sla": "1 день"
    }
  ],
  "branches": [
    {
      "stepId": "step_5",
      "condition": "Если клиент квалифицирован",
      "trueNext": "step_6",
      "falseNext": "step_7"
    }
  ],
  "documents": [
    {
      "stageId": "stage_1",
      "regulations": ["Регламент 1"],
      "templates": ["Шаблон 1", "Шаблон 2"]
    }
  ],
  "itIntegration": {
    "crmStatuses": ["Новый", "В работе", "Закрыт"],
    "automations": ["Создание задачи при новом лиде"],
    "dataStorage": ["Договоры в CRM", "Акты в 1С"],
    "notifications": ["Уведомление менеджеру о новом лиде"]
  },
  "improvements": [
    {
      "type": "risk" | "metric" | "automation",
      "title": "Заголовок",
      "description": "Описание",
      "priority": "high" | "medium" | "low"
    }
  ]
}`;

export const INTERVIEW_QUESTIONS_PROMPT = `На основе базовой информации о компании сгенерируй 8-12 уточняющих вопросов для построения бизнес-процесса.

Контекст компании:
Название: {companyName}
Отрасль: {industry}
Регион: {region}
Формат: {format}

Вопросы должны покрывать:
1. Кто основной клиент (тип, размер, регион)?
2. Какой тип сделки/проекта основной (разовый, долгосрочный, подписка)?
3. Что считается идеальным финалом процесса?
4. Какие ИТ-системы уже используются?
5. Какие роли уже есть в компании?
6. Нужен ли блок тендеров/конкурсов?
7. Есть ли формализованные регламенты?
8. Есть ли критичные ограничения по срокам (SLA)?
9. От какого события начинается процесс?
10. До какого события идет процесс?

Верни JSON массив вопросов:
[
  {
    "id": "q1",
    "question": "Текст вопроса",
    "category": "clients" | "deal_type" | "systems" | "roles" | "regulations" | "timeline" | "events"
  }
]`;

export const RECOMMENDATIONS_PROMPT = `Проанализируй бизнес-процесс компании и сгенерируй рекомендации по оптимизации.

Контекст компании:
Отрасль: {industry}
Регион: {region}

Бизнес-процесс:
{processData}

Сгенерируй рекомендации в следующих категориях:

1. ОПТИМИЗАЦИЯ - что можно улучшить в текущем процессе
2. АВТОМАТИЗАЦИЯ - какие шаги можно автоматизировать и какими инструментами:
   - CRM-системы (amoCRM, Битрикс24, Salesforce)
   - Чат-боты (для квалификации лидов, поддержки)
   - ИИ-инструменты (для обработки документов, анализа данных)
   - 1С (для бухгалтерии, складского учета)
   - Таблицы и базы данных (для структурирования данных)
   - Электронный документооборот
3. РИСКИ - узкие места и потенциальные проблемы
4. МЕТРИКИ - какие показатели нужно отслеживать

Для каждой рекомендации укажи:
- Приоритет (high/medium/low)
- Конкретные инструменты/решения
- Ожидаемый эффект

Верни JSON массив:
[
  {
    "category": "optimization" | "automation" | "risk" | "metric",
    "priority": "high" | "medium" | "low",
    "title": "Заголовок рекомендации",
    "description": "Детальное описание",
    "tools": ["CRM", "Чат-бот", "ИИ"],
    "expectedImpact": "Описание эффекта"
  }
]`;

export function buildProcessPrompt(context: string, interviewData: string): string {
  return BUSINESS_PROCESS_PROMPT
    .replace('{context}', context)
    .replace('{interviewData}', interviewData);
}

export function buildQuestionsPrompt(companyData: {
  companyName: string;
  industry: string;
  region: string;
  format: string;
}): string {
  return INTERVIEW_QUESTIONS_PROMPT
    .replace('{companyName}', companyData.companyName)
    .replace('{industry}', companyData.industry)
    .replace('{region}', companyData.region)
    .replace('{format}', companyData.format);
}

export function buildRecommendationsPrompt(industry: string, region: string, processData: string): string {
  return RECOMMENDATIONS_PROMPT
    .replace('{industry}', industry)
    .replace('{region}', region)
    .replace('{processData}', processData);
}
