# Business Process Builder

**Платформа для автоматизированного построения бизнес-процессов с помощью искусственного интеллекта**

Business Process Builder — это веб-приложение которое позволяет компаниям создавать детальные бизнес-процессы за 15 минут через голосовое интервью или заполнение анкеты. Система использует AI для анализа ответов и автоматической генерации BPMN-диаграмм с рекомендациями по оптимизации.

## Основные возможности

Платформа предоставляет комплексный инструментарий для моделирования и оптимизации бизнес-процессов компаний любого масштаба.

### Сбор данных о процессах

Система поддерживает три способа сбора информации о бизнес-процессах компании. **Голосовое интервью** позволяет пользователю отвечать на вопросы голосом с автоматической транскрипцией через Whisper API. **Полная анкета** содержит 50 детальных вопросов по 7 блокам (компания, клиенты, продукты, роли, процессы, системы, проблемы). **Сокращенная анкета** включает 10 ключевых вопросов для быстрого старта.

Все три формата поддерживают сохранение черновиков для возврата к заполнению позже и прикрепление документов (регламенты, инструкции, схемы) которые помогают AI лучше понять специфику бизнеса.

### Генерация и визуализация процессов

После завершения интервью или анкетирования AI анализирует собранные данные и генерирует детальный бизнес-процесс. Система создает **горизонтальную swimlane диаграмму** с этапами процесса сверху и дорожками ролей снизу. Каждый блок процесса содержит название шага, описание действий, ответственное лицо и время выполнения.

Диаграмма поддерживает различные типы узлов согласно нотации BPMN: Start (начало процесса), Action (действие), Decision (условие с ветвлением), Split (параллельное разделение), Merge (объединение веток), Event (событие) и End (завершение). Пользователь может переключаться между режимами просмотра и редактирования с возможностью перетаскивания элементов между этапами и ролями.

### Аналитика и метрики

Платформа автоматически рассчитывает ключевые показатели эффективности процесса. **Расчет времени** суммирует длительность всех шагов процесса с учетом параллельных веток. **Расчет затрат** вычисляет стоимость процесса на основе данных о зарплатах ролей и времени их участия в каждом шаге.

Система показывает распределение времени и затрат по ролям в виде таблиц и диаграмм что позволяет выявить узкие места и оптимизировать загрузку сотрудников.

### Варианты автоматизации через CRM

AI генерирует три варианта воронок для автоматизации процесса в CRM-системе с разным уровнем сложности. **Базовая воронка** содержит минимальный набор стадий для быстрого старта. **Детальная воронка** включает все подэтапы процесса с автоматизацией ключевых действий. **Полностью автоматизированная воронка** максимально использует возможности CRM с триггерами, уведомлениями и интеграциями.

Каждый вариант содержит описание стадий, соответствие шагам процесса, список автоматизаций, преимущества и недостатки для помощи в выборе оптимального решения.

### Рекомендации по документам

Система анализирует процесс и формирует список необходимых регламентов и шаблонов для структурирования деятельности компании. Для каждого документа указывается название, описание, приоритет внедрения (высокий/средний/низкий) и связанные этапы процесса.

Это помогает компаниям систематизировать операционную деятельность и снизить зависимость от конкретных сотрудников через документирование процедур.

### Экспорт и редактирование

Пользователи могут экспортировать полный отчет по процессу в PDF формате включая диаграмму, детальное описание всех этапов, метрики времени и затрат, варианты воронок CRM и список необходимых документов.

Диалоговое окно для запросов изменений позволяет пользователю текстом или голосом указать какие модификации нужно внести в процесс и AI автоматически обновит диаграмму и связанные данные.

## Технологический стек

Проект построен на современном стеке технологий обеспечивающем высокую производительность и удобство разработки.

### Frontend

Пользовательский интерфейс реализован на **React 19** с использованием **TypeScript** для типобезопасности. Стилизация выполнена через **Tailwind CSS 4** с готовыми компонентами из **shadcn/ui**. Маршрутизация организована через **Wouter** как легковесную альтернативу React Router.

Drag & drop функциональность реализована на базе библиотеки **@dnd-kit** которая обеспечивает плавное перетаскивание элементов диаграммы между этапами и ролями. Экспорт в PDF выполняется через **html2pdf.js** с рендерингом HTML-контента в PDF документ.

### Backend

Серверная часть построена на **Express 4** с полной поддержкой **TypeScript**. API организован через **tRPC 11** что обеспечивает end-to-end типобезопасность между клиентом и сервером без необходимости генерации кода.

Аутентификация реализована через **Manus OAuth** с автоматической регистрацией пользователей и управлением сессиями через JWT токены. Все процедуры разделены на публичные (publicProcedure) и защищенные (protectedProcedure) с автоматической проверкой авторизации.

### База данных

Проект использует **MySQL/TiDB** в качестве основной базы данных. ORM слой построен на **Drizzle ORM** с типобезопасными запросами и автоматической генерацией TypeScript типов из схемы.

Миграции управляются через **drizzle-kit** с командой `pnpm db:push` которая автоматически синхронизирует схему с базой данных. Все JSON поля (этапы процесса, роли, воронки CRM) хранятся в виде текстовых колонок с парсингом на уровне API.

### AI и интеграции

Генерация процессов выполняется через интеграцию с **LLM API** (Claude/GPT) с использованием структурированных промптов и JSON Schema для валидации ответов. Голосовая транскрипция реализована через **Whisper API** с поддержкой форматов webm, mp3, wav, ogg, m4a.

Файловое хранилище организовано через **S3-совместимое API** для загрузки документов пользователей и аудиозаписей интервью. Все файлы хранятся с уникальными ключами и публичными URL для доступа.

## Установка и запуск

Для локальной разработки требуется Node.js 22+ и доступ к MySQL/TiDB базе данных.

### Клонирование репозитория

```bash
git clone https://github.com/your-username/business-process-builder.git
cd business-process-builder
```

### Установка зависимостей

Проект использует pnpm в качестве менеджера пакетов для более быстрой установки и экономии дискового пространства.

```bash
pnpm install
```

### Настройка переменных окружения

Создайте файл `.env` в корне проекта на основе `.env.example` и заполните необходимые значения.

```env
# Database
DATABASE_URL=mysql://user:password@host:port/database

# JWT Secret
JWT_SECRET=your-secret-key-here

# Manus OAuth
VITE_APP_ID=your-app-id
OAUTH_SERVER_URL=https://api.manus.im
VITE_OAUTH_PORTAL_URL=https://auth.manus.im

# Owner Info
OWNER_OPEN_ID=your-open-id
OWNER_NAME=Your Name

# Manus Built-in APIs
BUILT_IN_FORGE_API_URL=https://forge.manus.im
BUILT_IN_FORGE_API_KEY=your-api-key
VITE_FRONTEND_FORGE_API_KEY=your-frontend-api-key
VITE_FRONTEND_FORGE_API_URL=https://forge.manus.im

# App Config
VITE_APP_TITLE=Business Process Builder
VITE_APP_LOGO=/logo.svg
```

### Инициализация базы данных

Выполните миграции для создания необходимых таблиц в базе данных.

```bash
pnpm db:push
```

### Запуск dev сервера

Запустите приложение в режиме разработки с hot reload.

```bash
pnpm dev
```

Приложение будет доступно по адресу `http://localhost:3000`

### Сборка для production

Создайте оптимизированную production сборку.

```bash
pnpm build
pnpm start
```

## Структура проекта

```
business-process-builder/
├── client/                 # Frontend приложение
│   ├── public/            # Статические файлы
│   └── src/
│       ├── components/    # React компоненты
│       ├── pages/         # Страницы приложения
│       ├── lib/           # Утилиты и конфигурация
│       └── hooks/         # Custom React hooks
├── server/                # Backend приложение
│   ├── _core/            # Ядро фреймворка (OAuth, context, LLM)
│   ├── db.ts             # Функции работы с БД
│   ├── routers.ts        # tRPC роутеры
│   ├── prompts.ts        # Промпты для AI
│   └── questions.ts      # Система вопросов анкеты
├── drizzle/              # Схема БД и миграции
│   └── schema.ts         # Определение таблиц
├── shared/               # Общий код между client и server
└── storage/              # S3 интеграция
```

## Основные команды

| Команда | Описание |
|---------|----------|
| `pnpm dev` | Запуск dev сервера с hot reload |
| `pnpm build` | Сборка production версии |
| `pnpm start` | Запуск production сервера |
| `pnpm db:push` | Применить изменения схемы БД |
| `pnpm lint` | Проверка кода линтером |
| `pnpm test` | Запуск тестов |

## Разработка

### Добавление нового функционала

Следуйте паттерну разработки описанному в шаблоне проекта.

Для добавления нового API endpoint создайте процедуру в `server/routers.ts` используя `publicProcedure` или `protectedProcedure`. Определите input схему через Zod для валидации входных данных. Реализуйте бизнес-логику с использованием функций из `server/db.ts` для работы с базой данных.

На фронтенде используйте `trpc.*.useQuery` для чтения данных и `trpc.*.useMutation` для изменений. Типы автоматически выводятся из серверных процедур без необходимости дублирования.

### Работа с базой данных

Все изменения схемы выполняются в файле `drizzle/schema.ts`. После модификации таблиц запустите `pnpm db:push` для применения изменений к базе данных.

Создавайте функции-хелперы в `server/db.ts` для переиспользования запросов между разными процедурами. Возвращайте сырые результаты Drizzle без дополнительной обработки.

### Интеграция с AI

Промпты для генерации процессов находятся в `server/prompts.ts`. Используйте функцию `invokeLLM` из `server/_core/llm.ts` для вызова AI с автоматической обработкой ошибок и повторными попытками.

Определяйте JSON Schema для структурированных ответов через параметр `response_format` чтобы гарантировать корректный формат данных от AI.

## Deployment

### Подготовка к деплою

Убедитесь что все переменные окружения настроены в production среде. Выполните сборку приложения командой `pnpm build`. Настройте reverse proxy (nginx/caddy) для проксирования запросов к Node.js серверу.

### Подключение домена

Для подключения собственного домена к приложению выполните следующие шаги.

Если вы используете платформу Manus для хостинга приложения, настройте домен через Management UI в разделе Settings → Domains. Для самостоятельного хостинга настройте DNS записи вашего домена на IP адрес сервера.

Подробная инструкция по подключению домена с reg.ru находится в файле `DOMAIN_SETUP.md`.

### SSL сертификаты

Для production окружения обязательно используйте HTTPS. Получите бесплатный SSL сертификат через Let's Encrypt используя certbot или аналогичные инструменты.

Настройте автоматическое обновление сертификатов через cron задачу чтобы избежать простоев при истечении срока действия.

## Лицензия

MIT License - см. файл LICENSE для деталей.

## Поддержка

Для вопросов и предложений создавайте issues в GitHub репозитории или свяжитесь с командой разработки.

---

**Создано с использованием Manus AI Platform**
